
@{
    ViewData["Title"] = "DragAndDrop";
    Layout = "~/Views/Shared/_DefaultLayout.cshtml";
}

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script src="///ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css"></script>

<style>
    #modules {
        padding: 20px;
        background: #eee;
        margin-bottom: 20px;
        z-index: 1;
        border-radius: 10px;
    }

    #dropzone {
        padding: 20px;
        background: #eee;
        min-height: 100px;
        margin-bottom: 20px;
        z-index: 0;
        border-radius: 10px;
    }

    .hover {
        outline: 1px solid blue;
    }

    .drop-item {
        cursor: pointer;
        margin-bottom: 10px;
        background-color: rgb(255, 255, 255);
        padding: 5px 10px;
        border-radisu: 3px;
        border: 1px solid rgb(204, 204, 204);
        position: relative;
    }

        .drop-item .remove {
            position: absolute;
            top: 4px;
            right: 4px;
        }
        </style>
<!-- ======= Breadcrumbs ======= -->
<div class="breadcrumbs d-flex align-items-center" style="background-image: url('assets/img/blog-header.jpg');">
    <div class="container position-relative d-flex flex-column align-items-center">

        <h2>Select Criteria</h2>
        <ol>
            <li><a href="/Filtering/FilterOptions">Filter Cities</a></li>
            <li>Select Criteria</li>
        </ol>

    </div>
</div>
<!-- End Breadcrumbs -->
<section id="why-us" class="why-us">
    <div class="container" data-aos="fade-up">
        <div class="section-header">
            <div class="container">
                <h2><small>Please select the 4 criteria that you pay most attention to when moving from the criteria in the list below. Drag and drop the criteria you selected to the right and click "save".</small></h2>
                <div class="row">
                    <div class="col-sm-6">
                        <div id="modules">
                            <p class="drag"><a class="btn btn-default">Business Freedom</a></p>
                            <p class="drag"><a class="btn btn-default">Safety</a></p>
                            <p class="drag"><a class="btn btn-default">Commute</a></p>
                            <p class="drag"><a class="btn btn-default">Startups</a></p>
                            <p class="drag"><a class="btn btn-default">Cost of living</a></p>
                            <p class="drag"><a class="btn btn-default">Education</a></p>
                            <p class="drag"><a class="btn btn-default">Environmental Quality</a></p>
                            <p class="drag"><a class="btn btn-default">Housing</a></p>
                            <p class="drag"><a class="btn btn-default">Leisure&Culture</a></p>
                            <p class="drag"><a class="btn btn-default">Taxation</a></p>
                            <p class="drag"><a class="btn btn-default">Economy</a></p>
                            <p class="drag"><a class="btn btn-default">Travel Connectivity</a></p>
                            <p class="drag"><a class="btn btn-default">Healthcare</a></p>
                            <p class="drag"><a class="btn btn-default">Healthcare</a></p>
                            <p class="drag"><a class="btn btn-default">Internet Access</a></p>
                            <p class="drag"><a class="btn btn-default">Outdoors</a></p>
                            <p class="drag"><a class="btn btn-default">Tolerance</a></p>
                        </div>
                    </div>

                    <div class="col-sm-6">
                        <div id="dropzone"></div>
                        <button class="btn btn-primary pull-right" onclick="SelectedCriteria()">Save</button>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<script type="text/javascript">
    $('.drag').draggable({
        appendTo: 'body',
        helper: 'clone'
    });

    $('#dropzone').droppable({
        activeClass: 'active',
        hoverClass: 'hover',
        accept: ":not(.ui-sortable-helper)", // Reject clones generated by sortable
        drop: function (e, ui) {
            var $el = $('<div class="drop-item"><details><summary>' + ui.draggable.text() + '</summary><div></div></details></div>');
            $el.append($('<button type="button" class="bi bi-trash3"><span class="glyphicon glyphicon-trash"></span></button>').click(function () { $(this).parent().detach(); }));
            $(this).append($el);
        }
    }).sortable({
        items: '.drop-item',
        sort: function () {
            // gets added unintentionally by droppable interacting with sortable
            // using connectWithSortable fixes this, but doesn't allow you to customize active/hoverClass options
            $(this).removeClass("active");
        }
    });

    function SelectedCriteria() {
        $.ajax({
            contentType: "application/json",
            dataType: "json",
            type: "get",
            url: "/CriteriaSelection/DragAndDrop/",
            success: function (funk1) {
                let values = jQuery.parseJSON(funk1);
                console.log(values);

                let tablehtml = '<table class= "table table-bordered"><tr><th>Continent</th><th>Country</th><th>City</th></tr>';
                $.each(values, (index, item) => {
                    tablehtml += `<tr><td>${item.Continent}</td><td>${item.Country}</td><td>${item.CityName}</td>`
                });

                tablehtml += '</tr></table>';
                $("#data").html(tablehtml);
            }
        });
    }

</script>

